<!DOCTYPE html>
        
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->

<title>Moving To Jekyll - Max Manders</title>
        
<meta charset="UTF-8" />
<meta name="keywords" content="jekyll, general" />
<meta name="author" content="Max Manders" />
        
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- Mobile Specific Metas
================================================== -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- CSS
================================================== -->
<link rel="stylesheet" href="/styles/stylesheets/base.css">
<link rel="stylesheet" href= "/styles/style.css">
<link rel="stylesheet" href="/styles/stylesheets/layout.css">
<link rel="stylesheet" href="/styles/highlight.css">
<link href='http://fonts.googleapis.com/css?family=Bree+Serif' rel='stylesheet' type='text/css'>

<!-- Favicons
================================================== -->
<link rel="shortcut icon" href="/favicon.ico" />

</head>

<body class="home blog">

<div class="container">

<div class="header">    
  <div class="seven columns"> 
    <div class="logo">
      <a href="/">
        <h1 class="remove-bottom">Max Manders</h1>
        <h5>thoughts of a web developer</h5>
      </a>
    </div>
  </div> 
</div>

<div class="content">
  <div class="column">
    <div class="main">
      <article class="post">
  <h3 class="post-title"><a href="/2012/07/01/moving-to-jekyll.html" title="Moving To Jekyll">Moving To Jekyll</a></h3>
  <span class="post-date"><abbr class="published-on">July 01, 2012</abbr></span>
  <div class="post-content">
    <p><p>I&#8217;ve been using <a title='Wordpress' href='http://www.wordpress.org'>Wordpress</a> to maintain my blog since early 2007. I have absolutely no complaints about Wordpress; it&#8217;s a fantastic blogging platform and CMS for users of all skill levels. However, I spend most of time at the command line, and use Vim as my text editor of choice. For those reasons, a trend I&#8217;ve seen among other developers of using <a href='https://github.com/mojombo/jekyll/'>Jekyll</a> very much appeals to me. <!--more--></p>

<h3 id='about_jekyll'>About Jekyll</h3>

<p>Jekyll is a &#8217;&#8230;blog-aware, static site generator in Ruby&#8230;&#8217;. At an extremely high level, It allows you to write pages and blog-posts using markdown syntax, and with a single command, mashes the markdown together with user-defined templates to generate static HTML files. Although I&#8217;m a PHP developer with no Ruby skills whatsoever, that doesn&#8217;t matter &#8211; it&#8217;s an extremely efficient and effective tool, hosted on <a href='http://github.com'>Github</a> and is comprehensively documented.</p>

<h3 id='how'>How</h3>

<p>Having read a number of web pages and guides, I concluded the most appropriate approach for my purposes would be to maintain my content history as a Git repository. This would allow me to write my posts locally, and use a pre-commit hook to generate and add any new HTML files to the repository. I could then deploy by pushing to a remote on my server, which would refresh the copy using a post-receive hook.</p>

<p>I identified the following steps would be required in order to migrate my existing Wordpress installation to use Jekyll:</p>

<ol>
<li>Install Jekyll and its dependencies.</li>

<li>Migrate existing Wordpress posts to markdown files.</li>

<li>Migrate existing Wordpress theme for use with Jekyll.</li>

<li>Configure deployment.</li>
</ol>

<h4 id='installation'>Installation</h4>

<p>From what I&#8217;ve read, I believe that the preferred way of managing third-party Ruby packages, or RubyGems, is via the Gem package manager; similar in some respects to Pear for PHP. However, in the past I&#8217;ve had varying mileage using that method, so I&#8217;ve chosen to stick the official Ubuntu packages. The following instructions apply to Ubuntu 12.04.</p>
<div class='highlight'><pre><code class='bash'><span class='lineno'>1</span> <span class='nv'>$ </span>sudo apt-get install ruby
<span class='lineno'>2</span> <span class='nv'>$ </span>sudo apt-get install rubygems
<span class='lineno'>3</span> <span class='nv'>$ </span>sudo apt-get install libmysql-ruby1.9.1
<span class='lineno'>4</span> <span class='nv'>$ </span>sudo apt-get install libhtmlentities-ruby1.9.1
<span class='lineno'>5</span> <span class='nv'>$ </span>sudo apt-get install python-pygments
<span class='lineno'>6</span> <span class='nv'>$ </span>sudo apt-get install ruby-liquid
<span class='lineno'>7</span> <span class='nv'>$ </span>sudo gem install jekyll 
</code></pre>
</div>
<h4 id='migration'>Migration</h4>

<p>The data migration was relatively straight forward, thanks to Jekyll&#8217;s out-of-the-box support for exporting Wordpress posts to markdown files. First, I took a dump of my live database and imported it to my local machine. Then, I took a clone of the Jekyll source and used the migration utility, as documented.</p>
<div class='highlight'><pre><code class='bash'><span class='lineno'>1</span>     git clone https://github.com/mojombo/jekyll.git
<span class='lineno'>2</span>     <span class='nb'>export </span><span class='nv'>DB</span><span class='o'>=</span>my_wp_database
<span class='lineno'>3</span>     <span class='nb'>export </span><span class='nv'>USER</span><span class='o'>=</span>my_wp_user
<span class='lineno'>4</span>     <span class='nb'>export </span><span class='nv'>PASS</span><span class='o'>=</span>my_wp_pass
<span class='lineno'>5</span>     ruby -r <span class='s1'>&#39;~/tmp/jekyll/lib/jekyll/migrators/wordpress&#39;</span> <span class='se'>\</span>
<span class='lineno'>6</span>         -e <span class='s1'>&#39;Jekyll::WordPress.process( &quot;#{ENV[&quot;DB&quot;]}&quot;, &quot;#{ENV[&quot;USER&quot;]}&quot;, &quot;#{ENV[&quot;PASS&quot;]}&quot;)&#39;</span>
<span class='lineno'>7</span>     
</code></pre>
</div>
<p>This resulted in the creation of a <code>_posts</code> directory, filled with markdown versions of all my posts, appropriately named. I copied this directory in to my own repository and ran <code>jekyll --pygments</code> over it to make sure everything looked okay.</p>

<p>Having successfully migrated my existing content, getting the theme set up was a fairly straight forward matter of copying my main Wordpress template into the <code>_layouts</code> directory and adjusting the template variables to suit Jekyll, rather than calling Wordpress template functions.</p>

<h4 id='deployment'>Deployment</h4>

<p>Although I still have cause to use SVN, I favour Git for most revision-control matters. Maintaining my blog is no exception, and it makes sense since all I&#8217;m really managing is a collection of static text files. I could have deployed to Github and used Github Pages to host my blog, but I&#8217;ve chose to host things myself. This was partly motivated by a desire to control and take responsibility for everything, since I already have Git working perfectly well on my server. The other motivation to do it myself was that you require a paid service to point a CNAME at Github Pages. I don&#8217;t have any use for private repositories so don&#8217;t use the paid service, and couldn&#8217;t justify the small cost purely to allow Github to host my blog.</p>

<p>So, ignoring the actual server deployment for now, the first thing I wanted was a mechanism whereby I could edit a post in a markdown file, and have the static HTML files in the <code>_site</code> directory automatically generated.</p>
<div class='highlight'><pre><code class='bash'><span class='lineno'>1</span>     <span class='c'>#!/bin/sh</span>
<span class='lineno'>2</span> 
<span class='lineno'>3</span>     <span class='nb'>echo</span> <span class='s2'>&quot;Building with Jekyll&quot;</span>
<span class='lineno'>4</span>     jekyll --pygments
<span class='lineno'>5</span>     git add -v -f _site
<span class='lineno'>6</span>     
</code></pre>
</div>
<p>The commands above live in <code>.git/hooks/pre-commit</code> and prior to actually adding the commit to the index will run Jekyll and add the <code>_site</code> directory to the commit. This is necessary because I&#8217;ve explicitly ignored <code>_site</code> in my <code>.gitignore</code> file.</p>

<p>This is complimented by a post-receive hook that refreshes the live copy of the repository. I have a bare repository that I push to, and a virtual host configured that points to a live clone of the bare repository. When I push to my remote origin, the following post-receive hook is run (<code>.git/hooks/post-receive</code>).</p>
<div class='highlight'><pre><code class='bash'><span class='lineno'> 1</span>     <span class='c'>#!/bin/sh</span>
<span class='lineno'> 2</span> 
<span class='lineno'> 3</span>     <span class='nv'>GIT_REPO</span><span class='o'>=</span>/path/to/bare/repo
<span class='lineno'> 4</span>     <span class='nv'>PUBLIC_WWW</span><span class='o'>=</span>/path/to/live/copy
<span class='lineno'> 5</span> 
<span class='lineno'> 6</span>     rm -Rf <span class='nv'>$PUBLIC_WWW</span>/*
<span class='lineno'> 7</span>     rm -Rf <span class='nv'>$PUBLIC_WWW</span>/.*
<span class='lineno'> 8</span>     <span class='nb'>cd</span> <span class='nv'>$PUBLIC_WWW</span>
<span class='lineno'> 9</span>     git clone <span class='nv'>$GIT_REPO</span> .
<span class='lineno'>10</span>     <span class='nb'>exit</span>
<span class='lineno'>11</span>     
</code></pre>
</div>
<p>This removes anything that&#8217;s currently live and clones a fresh copy that includes my newly added content.</p>

<h3 id='summary'>Summary</h3>

<p>I use a https://github.com/kinnetica/jekyll-pluginsenerator plugin) that is called when I run Jekyll, and updates my <code>sitemap.xml</code> file. Draft posts are created using Git branches. While there may be more succinct or efficient methods for managing it all, this works for me.</p></p>
  </div>
</article>
<div id="categories">
<span class="meta-header">Categories: </span>

  <a href="/categories/jekyll.html" rel="category">Jekyll</a>, 

  <a href="/categories/general.html" rel="category">General</a>, 

  <a href="/categories/linux.html" rel="category">Linux</a>

</div>
<div id="tags">
<span class="meta-header">Tags: </span>

  <a href="/tags/jekyll.html" rel="tag">jekyll</a>, 

  <a href="/tags/general.html" rel="tag">general</a>
 
</tags>

<div id="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'maxmanders';
    var disqus_identifier = '/2012/07/01/moving-to-jekyll';
    var disqus_url = 'http://maxmanders.co.uk//2012/07/01/moving-to-jekyll.html';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
</div>



      <div class="nav-below"> 
        
          <div class="nav-previous"></div>
        
        
          <div class="nav-next"></div>
        
      </div>
    </div>
  </div>
<!-- nav -->
</div>

<div class="clear"></div>
<div class="footer">
  <div class="column">
    <div class="row">
      <div class="eight columns alpha">
      <h4>About Me</h4>
      <p><a href="/about.html">I'm</a> an Edinburgh based PHP developer with a passion for <a href="http://en.wikipedia.org/wiki/Open_source">open source software</a> and <a href="http://en.wikipedia.org/wiki/Open_data">open-data</a>, currently working for <a href="http://maglabs.net" rel="co-worker met">Maglabs</a>. Living with my wife <a href="http://twitter.com/mrsjmanders" rel="met spouse">Jo</a> and our two cats, Ziggy and Maggie.</p>
      <p><a href="/about.html">Continue reading</a></p>
      <h4>Contact</h4>
      <p>If you want to get in touch, you can send an email to my-first-name [at] this site.</p>
      </div>
      <div class="eight columns omega">
        <div class="row">
          <div class="four columns alpha">
            <ul>
              <li>
                <img alt="Pinboard" src="/images/link.png" />
                <a href="http://www.pinboard.in/u:maxmanders/" title="maxmanders on Pinboard">Pinboard</a>
              </li>
              <li>
                <img alt="Flickr" src="/images/picture.png" />
                <a href="http://www.flickr.com/photos/maxmanders" title="maxmanders on Flickr">Flickr</a>
              </li>
              <li>
                <img alt="Last.FM" src="/images/song.png" />
                <a href="http://www.last.fm/user/mmanders" title="mmanders on Last.FM">Last.FM</a>
              </li>
              <li>
                <img alt="Twitter" src="/images/message.png" />
                <a href="http://www.twitter.com/maxmanders" title="maxmanders on Twitter">Twitter</a>
              </li>
              <li>
                <img alt="Github" src="/images/github.png" />
                <a href="http://www.github.com/maxmanders" title="maxmanders on Github">Github</a>
              </li>
              <li>
                <img alt="RSS" src="/images/maxmanders.png" />
                <a href="http://maxmanders.co.uk/feed/rss2" title="maxmanders.co.uk RSS">RSS</a>
              </li>
            </ul>
          </div>
          <div class="four columns omega">

          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="column alpha" id="license">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons Licence" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png" /></a>
        <span>&nbsp; This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.</span>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
  var pageTracker = _gat._getTracker("UA-1652642-1");
  pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
</html>
